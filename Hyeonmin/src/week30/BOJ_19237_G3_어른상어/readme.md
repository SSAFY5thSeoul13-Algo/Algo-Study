## BOJ 19237 G3 ì–´ë¥¸ ìƒì–´
- êµ¬í˜„
- ì‹œë®¬ë ˆì´ì…˜
- gold3

<br>


### ğŸ” ë¬¸ì œ ì„¤ëª…
https://www.acmicpc.net/problem/19237

ì²­ì†Œë…„ ìƒì–´ëŠ” ë”ìš± ìë¼ ì–´ë¥¸ ìƒì–´ê°€ ë˜ì—ˆë‹¤. ìƒì–´ê°€ ì‚¬ëŠ” ê³µê°„ì— ë” ì´ìƒ ë¬¼ê³ ê¸°ëŠ” ì˜¤ì§€ ì•Šê³  ë‹¤ë¥¸ ìƒì–´ë“¤ë§Œì´ ë‚¨ì•„ìˆë‹¤. ìƒì–´ì—ëŠ” 1 ì´ìƒ M ì´í•˜ì˜ ìì—°ìˆ˜ ë²ˆí˜¸ê°€ ë¶™ì–´ ìˆê³ , ëª¨ë“  ë²ˆí˜¸ëŠ” ì„œë¡œ ë‹¤ë¥´ë‹¤. ìƒì–´ë“¤ì€ ì˜ì—­ì„ ì‚¬ìˆ˜í•˜ê¸° ìœ„í•´ ë‹¤ë¥¸ ìƒì–´ë“¤ì„ ì«“ì•„ë‚´ë ¤ê³  í•˜ëŠ”ë°, 1ì˜ ë²ˆí˜¸ë¥¼ ê°€ì§„ ì–´ë¥¸ ìƒì–´ëŠ” ê°€ì¥ ê°•ë ¥í•´ì„œ ë‚˜ë¨¸ì§€ ëª¨ë‘ë¥¼ ì«“ì•„ë‚¼ ìˆ˜ ìˆë‹¤.

NÃ—N í¬ê¸°ì˜ ê²©ì ì¤‘ Mê°œì˜ ì¹¸ì— ìƒì–´ê°€ í•œ ë§ˆë¦¬ì”© ë“¤ì–´ ìˆë‹¤. ë§¨ ì²˜ìŒì—ëŠ” ëª¨ë“  ìƒì–´ê°€ ìì‹ ì˜ ìœ„ì¹˜ì— ìì‹ ì˜ ëƒ„ìƒˆë¥¼ ë¿Œë¦°ë‹¤. ê·¸ í›„ 1ì´ˆë§ˆë‹¤ ëª¨ë“  ìƒì–´ê°€ ë™ì‹œì— ìƒí•˜ì¢Œìš°ë¡œ ì¸ì ‘í•œ ì¹¸ ì¤‘ í•˜ë‚˜ë¡œ ì´ë™í•˜ê³ , ìì‹ ì˜ ëƒ„ìƒˆë¥¼ ê·¸ ì¹¸ì— ë¿Œë¦°ë‹¤. ëƒ„ìƒˆëŠ” ìƒì–´ê°€ kë²ˆ ì´ë™í•˜ê³  ë‚˜ë©´ ì‚¬ë¼ì§„ë‹¤.

ê° ìƒì–´ê°€ ì´ë™ ë°©í–¥ì„ ê²°ì •í•  ë•ŒëŠ”, ë¨¼ì € ì¸ì ‘í•œ ì¹¸ ì¤‘ ì•„ë¬´ ëƒ„ìƒˆê°€ ì—†ëŠ” ì¹¸ì˜ ë°©í–¥ìœ¼ë¡œ ì¡ëŠ”ë‹¤. ê·¸ëŸ° ì¹¸ì´ ì—†ìœ¼ë©´ ìì‹ ì˜ ëƒ„ìƒˆê°€ ìˆëŠ” ì¹¸ì˜ ë°©í–¥ìœ¼ë¡œ ì¡ëŠ”ë‹¤. ì´ë•Œ ê°€ëŠ¥í•œ ì¹¸ì´ ì—¬ëŸ¬ ê°œì¼ ìˆ˜ ìˆëŠ”ë°, ê·¸ ê²½ìš°ì—ëŠ” íŠ¹ì •í•œ ìš°ì„ ìˆœìœ„ë¥¼ ë”°ë¥¸ë‹¤. ìš°ì„ ìˆœìœ„ëŠ” ìƒì–´ë§ˆë‹¤ ë‹¤ë¥¼ ìˆ˜ ìˆê³ , ê°™ì€ ìƒì–´ë¼ë„ í˜„ì¬ ìƒì–´ê°€ ë³´ê³  ìˆëŠ” ë°©í–¥ì— ë”°ë¼ ë˜ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤. ìƒì–´ê°€ ë§¨ ì²˜ìŒì— ë³´ê³  ìˆëŠ” ë°©í–¥ì€ ì…ë ¥ìœ¼ë¡œ ì£¼ì–´ì§€ê³ , ê·¸ í›„ì—ëŠ” ë°©ê¸ˆ ì´ë™í•œ ë°©í–¥ì´ ë³´ê³  ìˆëŠ” ë°©í–¥ì´ ëœë‹¤.

ëª¨ë“  ìƒì–´ê°€ ì´ë™í•œ í›„ í•œ ì¹¸ì— ì—¬ëŸ¬ ë§ˆë¦¬ì˜ ìƒì–´ê°€ ë‚¨ì•„ ìˆìœ¼ë©´, ê°€ì¥ ì‘ì€ ë²ˆí˜¸ë¥¼ ê°€ì§„ ìƒì–´ë¥¼ ì œì™¸í•˜ê³  ëª¨ë‘ ê²©ì ë°–ìœ¼ë¡œ ì«“ê²¨ë‚œë‹¤.

1ë²ˆ ìƒì–´ë§Œ ê²©ìì— ë‚¨ê²Œ ë˜ê¸°ê¹Œì§€ ëª‡ ì´ˆê°€ ê±¸ë¦¬ëŠ”ì§€ë¥¼ êµ¬í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ì‹œì˜¤.


#### ì…ë ¥
ì²« ì¤„ì—ëŠ” N, M, kê°€ ì£¼ì–´ì§„ë‹¤. (2 â‰¤ N â‰¤ 20, 2 â‰¤ M â‰¤ N2, 1 â‰¤ k â‰¤ 1,000)

ê·¸ ë‹¤ìŒ ì¤„ë¶€í„° Nê°œì˜ ì¤„ì— ê±¸ì³ ê²©ìì˜ ëª¨ìŠµì´ ì£¼ì–´ì§„ë‹¤. 0ì€ ë¹ˆì¹¸ì´ê³ , 0ì´ ì•„ë‹Œ ìˆ˜ xëŠ” xë²ˆ ìƒì–´ê°€ ë“¤ì–´ìˆëŠ” ì¹¸ì„ ì˜ë¯¸í•œë‹¤.

ê·¸ ë‹¤ìŒ ì¤„ì—ëŠ” ê° ìƒì–´ì˜ ë°©í–¥ì´ ì°¨ë¡€ëŒ€ë¡œ ì£¼ì–´ì§„ë‹¤. 1, 2, 3, 4ëŠ” ê°ê° ìœ„, ì•„ë˜, ì™¼ìª½, ì˜¤ë¥¸ìª½ì„ ì˜ë¯¸í•œë‹¤.

ê·¸ ë‹¤ìŒ ì¤„ë¶€í„° ê° ìƒì–´ì˜ ë°©í–¥ ìš°ì„ ìˆœìœ„ê°€ ìƒì–´ ë‹¹ 4ì¤„ì”© ì°¨ë¡€ëŒ€ë¡œ ì£¼ì–´ì§„ë‹¤. ê° ì¤„ì€ 4ê°œì˜ ìˆ˜ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. í•˜ë‚˜ì˜ ìƒì–´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë„¤ ì¤„ ì¤‘ ì²« ë²ˆì§¸ ì¤„ì€ í•´ë‹¹ ìƒì–´ê°€ ìœ„ë¥¼ í–¥í•  ë•Œì˜ ë°©í–¥ ìš°ì„ ìˆœìœ„, ë‘ ë²ˆì§¸ ì¤„ì€ ì•„ë˜ë¥¼ í–¥í•  ë•Œì˜ ìš°ì„ ìˆœìœ„, ì„¸ ë²ˆì§¸ ì¤„ì€ ì™¼ìª½ì„ í–¥í•  ë•Œì˜ ìš°ì„ ìˆœìœ„, ë„¤ ë²ˆì§¸ ì¤„ì€ ì˜¤ë¥¸ìª½ì„ í–¥í•  ë•Œì˜ ìš°ì„ ìˆœìœ„ì´ë‹¤. ê° ìš°ì„ ìˆœìœ„ì—ëŠ” 1ë¶€í„° 4ê¹Œì§€ì˜ ìì—°ìˆ˜ê°€ í•œ ë²ˆì”© ë‚˜íƒ€ë‚œë‹¤. ê°€ì¥ ë¨¼ì € ë‚˜ì˜¤ëŠ” ë°©í–¥ì´ ìµœìš°ì„ ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìš°ì„ ìˆœìœ„ê°€ 1 3 2 4ë¼ë©´, ë°©í–¥ì˜ ìˆœì„œëŠ” ìœ„, ì™¼ìª½, ì•„ë˜, ì˜¤ë¥¸ìª½ì´ë‹¤.

ë§¨ ì²˜ìŒì—ëŠ” ê° ìƒì–´ë§ˆë‹¤ ì¸ì ‘í•œ ë¹ˆ ì¹¸ì´ ì¡´ì¬í•œë‹¤. ë”°ë¼ì„œ ì²˜ìŒë¶€í„° ì´ë™ì„ ëª» í•˜ëŠ” ê²½ìš°ëŠ” ì—†ë‹¤.

#### ì¶œë ¥
1ë²ˆ ìƒì–´ë§Œ ê²©ìì— ë‚¨ê²Œ ë˜ê¸°ê¹Œì§€ ê±¸ë¦¬ëŠ” ì‹œê°„ì„ ì¶œë ¥í•œë‹¤. ë‹¨, 1,000ì´ˆê°€ ë„˜ì–´ë„ ë‹¤ë¥¸ ìƒì–´ê°€ ê²©ìì— ë‚¨ì•„ ìˆìœ¼ë©´ -1ì„ ì¶œë ¥í•œë‹¤.

###  ğŸ’¡ í’€ì´

1. ê° ìƒì–´ì˜ í˜„ì¬ ìœ„ì¹˜ë¥¼ `sharkArr`ì— ì €ì¥

```java
		for (int i = 0; i < N; i++) {
			st = new StringTokenizer(br.readLine());
			for (int j = 0; j < N; j++) {
				int num = Integer.parseInt(st.nextToken());
				
				map[i][j] = new Node(num,0);
				
				if(num !=0) {
					sharkArr[num] = new Shark(i,j,num,0);
				}
			}
		}
```

2. ê° ìƒì–´ì˜ ì´ˆê¸° ë°©í–¥ê³¼ ìš°ì„ ìˆœìœ„ë¥¼ ì €ì¥


```java
		for (int i = 0; i <= M; i++) {
			priorityList.add(new ArrayList<List<Integer>>());
		}
		
		//ìƒì–´ì˜ ì´ˆê¸° ë°©í–¥
		for (int i = 1; i <= M; i++) {
			Shark shark = sharkArr[i];
			shark.dir = Integer.parseInt(st.nextToken());
			for (int j = 0; j < 5; j++) {
				priorityList.get(i).add(new ArrayList<Integer>());
			}
		}

		//ê° ìƒì–´ì˜ ìš°ì„ ìˆœìœ„ ì €ì¥
		for (int i = 0; i < 4*M; i++) {
			st = new StringTokenizer(br.readLine());
			
			int idx = i/4+1;
			int dir = i%4+1;
			
			for (int j = 0; j < 4; j++) {
				int num = Integer.parseInt(st.nextToken());
				priorityList.get(idx).get(dir).add(num);
			}
		}
```

3. ê° ìƒì–´ì˜ ì´ë™ìœ„ì¹˜ í™•ì¸ ë° ì´ë™

```java
		while(deadCount < M - 1 && time <= 1000) {
			//ê° ìƒì–´ ì´ë™ìœ„ì¹˜ íƒìƒ‰
			for (int i = 1; i <= M; i++) {
				Shark shark = sharkArr[i];
				
				if(shark.isDead)	continue;
				
				//ì£¼ë³€ì— ë¹„ê³³ìœ¼ë¡œ ì´ë™
				boolean isFound = findEmpty(shark, i);
				
				//ë‚´ ëƒ„ìƒˆê°€ ìˆëŠ” ê³³ìœ¼ë¡œ ì´ë™
				if(!isFound)	findMySmell(shark, i);
			}
			
			time++;
			
			//ê° ìƒì–´ ì´ë™
			move();
		}
```

3-1. ìƒì–´ ì£¼ë³€ ë¹ˆ ìœ„ì¹˜ í™•ì¸

```java
	static boolean findEmpty(Shark shark, int idx) {
		List<Integer> dirList = priorityList.get(idx).get(shark.dir);
		
		for (Integer dir : dirList) {
			int ny = shark.y + delta[dir][0];
			int nx = shark.x + delta[dir][1];
			
			if(isIn(ny, nx)) {
				Node node = map[ny][nx];
				
				//ëƒ„ìƒˆê°€ ì—†ëŠ” ê²½ìš°
				if(time - node.time >= K || node.num == 0) {
					shark.y = ny;
					shark.x = nx;
					shark.dir = dir;
					
					sharkQ.offer(shark);
					
					return true;
				}
			}
		}
		
		return false;
	}
```

3-2. ìƒì–´ ì£¼ë³€ ìê¸° ëƒ„ìƒˆ ìœ„ì¹˜ í™•ì¸

```java
	static void findMySmell(Shark shark, int idx) {
		List<Integer> dirList = priorityList.get(idx).get(shark.dir);
		
		for (Integer dir : dirList) {
			int ny = shark.y + delta[dir][0];
			int nx = shark.x + delta[dir][1];
			
			if(isIn(ny, nx)) {
				Node node = map[ny][nx];
				
				//ë‚´ ëƒ„ìƒˆê°€ ìˆëŠ” ê²½ìš°
				if(time - node.time < K && node.num == shark.num) {
					shark.y = ny;
					shark.x = nx;
					shark.dir = dir;
					
					sharkQ.offer(shark);
					
					return;
				}
			}
		}
	}
```

3-3. ìƒì–´ ì´ë™

```java
	static void move() {
		while(!sharkQ.isEmpty()) {
			Shark shark = sharkQ.poll();
			int y = shark.y;
			int x = shark.x;
			
			Node node = map[y][x];

			//ì£½ìŒ
			if(node.time == time && node.num != 0 && node.num < shark.num) {
				shark.isDead = true;
				deadCount++;
			}
			else {
				node.num = shark.num;
				node.time = time;
			}
		}
	}
```



<br><br>

###  ğŸ’¡ ì†ŒìŠ¤ì½”ë“œ
```java
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;
import java.util.Queue;
import java.util.StringTokenizer;

public class BOJ_19237_G3_ì–´ë¥¸ìƒì–´ {
	//ê° ìœ„ì¹˜ì˜ ì •ë³´
	static class Node{
		int num;
		int time;
		
		public Node(int num, int time) {
			super();
			this.num = num;
			this.time = time;
		}
	}
	
	//ìƒì–´ì˜ ì •ë³´
	static class Shark{
		int y;
		int x;
		int num;
		int dir; 
		boolean isDead = false;
		
		public Shark(int y, int x, int num, int dir) {
			super();
			this.y = y;
			this.x = x;
			this.num = num;
			this.dir = dir;
		}
	}
	
	static int N, M, K, time, deadCount;
	//ì´ë™ ì˜ˆì •ì¸ ìƒì–´
	static Queue<Shark> sharkQ = new LinkedList<>();
	//ìƒì–´ ë°°ì—´
	static Shark[] sharkArr;
	static Node[][] map;
	//ê° ìƒì–´ì˜ ë°©í–¥ì— ë”°ë¥¸ ë‹¤ìŒ ì´ë™ ìš°ì„ ìˆœìœ„
	static List<List<List<Integer>>> priorityList = new ArrayList<>();
	static int[][] delta= {
			{0,0},
			{-1,0},
			{1,0},
			{0,-1},
			{0,1}
	};
	

	public static void main(String[] args) throws Exception{
		BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
		
		StringTokenizer st = new StringTokenizer(br.readLine());
		
		N = Integer.parseInt(st.nextToken());
		M = Integer.parseInt(st.nextToken());
		K = Integer.parseInt(st.nextToken());
		
		map = new Node[N][N];
		sharkArr = new Shark[M+1];
		sharkArr[0] = new Shark(0,0,0,0);
		
		//ìƒì–´ì™€ ë§µ ì •ë³´ ì €ì¥
		for (int i = 0; i < N; i++) {
			st = new StringTokenizer(br.readLine());
			for (int j = 0; j < N; j++) {
				int num = Integer.parseInt(st.nextToken());
				
				map[i][j] = new Node(num,0);
				
				if(num !=0) {
					sharkArr[num] = new Shark(i,j,num,0);
				}
			}
		}
		
		st = new StringTokenizer(br.readLine());
		
		for (int i = 0; i <= M; i++) {
			priorityList.add(new ArrayList<List<Integer>>());
		}
		
		//ìƒì–´ì˜ ì´ˆê¸° ë°©í–¥
		for (int i = 1; i <= M; i++) {
			Shark shark = sharkArr[i];
			shark.dir = Integer.parseInt(st.nextToken());
			for (int j = 0; j < 5; j++) {
				priorityList.get(i).add(new ArrayList<Integer>());
			}
		}

		//ê° ìƒì–´ì˜ ìš°ì„ ìˆœìœ„ ì €ì¥
		for (int i = 0; i < 4*M; i++) {
			st = new StringTokenizer(br.readLine());
			
			int idx = i/4+1;
			int dir = i%4+1;
			
			for (int j = 0; j < 4; j++) {
				int num = Integer.parseInt(st.nextToken());
				priorityList.get(idx).get(dir).add(num);
			}
		}
		
		
		while(deadCount < M - 1 && time <= 1000) {
			//ê° ìƒì–´ ì´ë™ìœ„ì¹˜ íƒìƒ‰
			for (int i = 1; i <= M; i++) {
				Shark shark = sharkArr[i];
				
				if(shark.isDead)	continue;
				
				//ì£¼ë³€ì— ë¹„ê³³ìœ¼ë¡œ ì´ë™
				boolean isFound = findEmpty(shark, i);
				
				//ë‚´ ëƒ„ìƒˆê°€ ìˆëŠ” ê³³ìœ¼ë¡œ ì´ë™
				if(!isFound)	findMySmell(shark, i);
			}
			
			time++;
			
			//ê° ìƒì–´ ì´ë™
			move();
		}
		
		System.out.println(time > 1000 ? -1 : time);
	}
	
	//ê° ìƒì–´ ì´ë™
	static void move() {
		while(!sharkQ.isEmpty()) {
			Shark shark = sharkQ.poll();
			int y = shark.y;
			int x = shark.x;
			
			Node node = map[y][x];

			//ì£½ìŒ
			if(node.time == time && node.num != 0 && node.num < shark.num) {
				shark.isDead = true;
				deadCount++;
			}
			else {
				node.num = shark.num;
				node.time = time;
			}
		}
	}
	
	static boolean findEmpty(Shark shark, int idx) {
		List<Integer> dirList = priorityList.get(idx).get(shark.dir);
		
		for (Integer dir : dirList) {
			int ny = shark.y + delta[dir][0];
			int nx = shark.x + delta[dir][1];
			
			if(isIn(ny, nx)) {
				Node node = map[ny][nx];
				
				//ëƒ„ìƒˆê°€ ì—†ëŠ” ê²½ìš°
				if(time - node.time >= K || node.num == 0) {
					shark.y = ny;
					shark.x = nx;
					shark.dir = dir;
					
					sharkQ.offer(shark);
					
					return true;
				}
			}
		}
		
		return false;
	}
	
	static void findMySmell(Shark shark, int idx) {
		List<Integer> dirList = priorityList.get(idx).get(shark.dir);
		
		for (Integer dir : dirList) {
			int ny = shark.y + delta[dir][0];
			int nx = shark.x + delta[dir][1];
			
			if(isIn(ny, nx)) {
				Node node = map[ny][nx];
				
				//ë‚´ ëƒ„ìƒˆê°€ ìˆëŠ” ê²½ìš°
				if(time - node.time < K && node.num == shark.num) {
					shark.y = ny;
					shark.x = nx;
					shark.dir = dir;
					
					sharkQ.offer(shark);
					
					return;
				}
			}
		}
	}
	
	static boolean isIn(int y, int x) {
		if(y < 0 || x < 0 || y >= N || x >= N)	return false;
		
		return true;
	}
}





```


<br>



ë©”ëª¨ë¦¬|ì‹œê°„
--|--
18896 KB|192 ms